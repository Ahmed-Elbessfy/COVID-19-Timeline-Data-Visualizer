(function(t){function a(a){for(var r,s,o=a[0],c=a[1],l=a[2],d=0,v=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&v.push(n[s][0]),n[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(a);while(v.length)v.shift()();return i.push.apply(i,l||[]),e()}function e(){for(var t,a=0;a<i.length;a++){for(var e=i[a],r=!0,o=1;o<e.length;o++){var c=e[o];0!==n[c]&&(r=!1)}r&&(i.splice(a--,1),t=s(s.s=e[0]))}return t}var r={},n={app:0},i=[];function s(a){if(r[a])return r[a].exports;var e=r[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=t,s.c=r,s.d=function(t,a,e){s.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,a){if(1&a&&(t=s(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var r in t)s.d(e,r,function(a){return t[a]}.bind(null,r));return e},s.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(a,"a",a),a},s.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=a,o=o.slice();for(var l=0;l<o.length;l++)a(o[l]);var u=c;i.push([0,"chunk-vendors"]),e()})({0:function(t,a,e){t.exports=e("56d7")},"4a12":function(t,a,e){},"56d7":function(t,a,e){"use strict";e.r(a);e("e260"),e("e6cf"),e("cca6"),e("a79d");var r=e("2b0e"),n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"app"}},[t.dataNow&&t.dataHistory&&t.dataUK?e("div",{staticClass:"mContent"},[e("div",{staticClass:"title"},[t._v("今日概览")]),e("div",{staticClass:"overview mBlock"},[e("div",{staticClass:"overview_item",staticStyle:{color:"#ff5151"}},[e("div",{staticClass:"overview_title"},[t._v("累计确诊")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[0].confirmed))]),e("div",{staticClass:"daily-increase"},[t._v(t._s("+"+t.dataUK.dailyConfirmed))])]),e("div",{staticClass:"overview_item",staticStyle:{color:"#575757"}},[e("div",{staticClass:"overview_title"},[t._v("累计死亡")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[0].death))]),e("div",{staticClass:"daily-increase"},[t._v(t._s("+"+(t.todayData.death-t.yestData.death)))])]),e("div",{staticClass:"overview_item",staticStyle:{color:"#0094b9"}},[e("div",{staticClass:"overview_title"},[t._v("累计测试")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[0].tested))]),e("div",{staticClass:"daily-increase"},[t._v(" "+t._s("+"+(t.todayData.tested-t.yestData.tested))+" ")])]),e("div",{staticClass:"overview_item",staticStyle:{color:"#28ca00"}},[e("div",{staticClass:"overview_title"},[t._v("累计治愈")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[1].cured))]),e("div",{staticClass:"daily-increase"},[t._v(t._s("+"+(t.todayData.cured-t.yestData.cured)))])])]),e("div",{staticClass:"title"},[t._v("国家概览")]),e("div",{staticClass:"overview mBlock"},[e("div",{staticClass:"overview_item"},[e("div",{staticClass:"overview_title"},[t._v("英格兰")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[0].england))]),e("div",{staticClass:"country-death"},[t._v(t._s(t.dataUK.englandDeceased))])]),e("div",{staticClass:"overview_item"},[e("div",{staticClass:"overview_title"},[t._v("苏格兰")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[0].scotland))]),e("div",{staticClass:"country-death"},[t._v(t._s(t.dataUK.scottlandDeceased))])]),e("div",{staticClass:"overview_item"},[e("div",{staticClass:"overview_title"},[t._v("威尔士")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[0].wales))]),e("div",{staticClass:"country-death"},[t._v(t._s(t.dataUK.walesDeceased))])]),e("div",{staticClass:"overview_item"},[e("div",{staticClass:"overview_title"},[t._v("北爱尔兰")]),e("div",{staticClass:"overview_number"},[t._v(t._s(t.dataNow[0].nireland))]),e("div",{staticClass:"country-death"},[t._v(t._s(t.dataUK.northenIrelandDeceased))])])]),e("div",{ref:"navPlaceholder",attrs:{id:"navPlaceholder"}}),e("div",{ref:"nav",staticClass:"mNav",attrs:{id:"mNavbar"}},[e("ul",{directives:[{name:"scroll-spy-active",rawName:"v-scroll-spy-active",value:{selector:"li a",class:"active",offset:50},expression:"{selector: 'li a', class: 'active', offset: 50}"},{name:"scroll-spy-link",rawName:"v-scroll-spy-link"}],staticClass:"nav nav-pills nav-fill"},[t._m(0),t._m(1),t._m(2)])]),e("div",{directives:[{name:"scroll-spy",rawName:"v-scroll-spy",value:{data:"section"},expression:"{data: 'section'}"}]},[e("div",{staticClass:"mSection",attrs:{id:"charts"}},[e("div",{staticClass:"title"},[t._v("确诊及死亡")]),e("Chart",{attrs:{id:"confirmedAndDeathChart1",type:"area",dataHistory:t.dataHistory,seriesData:t.confirmedAndDeathChart1}}),e("div",{staticClass:"title"},[t._v("新增死亡")]),e("Chart",{attrs:{id:"deathChart2",type:"bar",stacked:!0,dataHistory:t.dataHistory,seriesData:t.deathChart2,colors:["#c40000","#3d000d","#2c9100"]}}),e("div",{staticClass:"title"},[t._v("死亡率及治愈率")]),e("Chart",{attrs:{id:"rateChart3",type:"area",dataHistory:t.dataHistory,seriesData:t.rateChart3,colors:["#ca0011","#0088ff"]}})],1),e("div",{staticClass:"mSection",attrs:{id:"animation"}},[e("div",{staticClass:"title"},[t._v("数据动画")]),e("BarRace")],1),e("div",{staticClass:"mSection",attrs:{id:"regionData"}},[e("div",{staticClass:"title"},[t._v("地区列表")]),e("RegionTable",{attrs:{dataNow:t.dataNow,dataYesterday:t.dataHistory[t.dataHistory.length-1]}})],1)])]):t._e()])},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#charts"}},[t._v("当前数据")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#animation"}},[t._v("数据动画")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#regionData"}},[t._v("地图列表")])])}],s=(e("d81d"),e("d3b7"),e("96cf"),e("c964")),o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mBlock"},[e("div",{staticClass:"btn-group-wrap"},[e("div",{staticClass:"btn-group btn-group-sm",attrs:{role:"group","aria-label":"date range"}},[e("button",{staticClass:"btn btn-secondary",class:{active:-7===t.range},attrs:{type:"button"},on:{click:function(a){return t.updateRange(-7,!0)}}},[t._v(" 一周内 ")]),e("button",{staticClass:"btn btn-secondary",class:{active:-14===t.range},attrs:{type:"button"},on:{click:function(a){return t.updateRange(-14,!0)}}},[t._v(" 两周内 ")]),e("button",{staticClass:"btn btn-secondary",class:{active:-31===t.range},attrs:{type:"button"},on:{click:function(a){return t.updateRange(-31,!1)}}},[t._v(" 一个月内 ")]),e("button",{staticClass:"btn btn-secondary",class:{active:0===t.range},attrs:{type:"button"},on:{click:function(a){return t.updateRange(0,!1)}}},[t._v(" 全部数据 ")])])]),e("VueApexCharts",{attrs:{width:"100%",type:t.type,options:t.options,series:t.series}})],1)},c=[],l=(e("fb6a"),e("1321")),u=e.n(l),d={name:"Chart",components:{VueApexCharts:u.a},props:{seriesData:Array,dataHistory:Array,id:String,type:String,colors:Array,stacked:Boolean},data:function(){return{showLabel:!1,range:-31}},methods:{updateRange:function(t,a){this.range=t,this.showLabel=a}},computed:{series:function(){var t=this;return this.seriesData.map((function(a){return a.originalData=a.originalData?a.originalData:a.data,a.data=a.originalData.slice(t.range),a}))},options:function(){return{chart:{id:this.id,height:350,type:this.type?this.type:"line",stacked:this.stacked,zoom:{enabled:window.innerWidth>800}},colors:this.colors?this.colors:["#ff0000","#3d0707"],dataLabels:{enabled:this.showLabel,textAnchor:"middle",dropShadow:{enabled:!0}},stroke:{curve:"smooth"},grid:{row:{colors:["#f3f3f3","transparent"],opacity:.5}},xaxis:{type:"datetime",categories:this.dataHistory.map((function(t){return t.date})).slice(this.range),labels:{format:"dd/MM",rotate:-10}}}}}},v=d,f=e("2877"),h=Object(f["a"])(v,o,c,!1,null,"c4064dee",null),p=h.exports,m=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mBlock"},[e("div",{staticClass:"btn-group-wrap"},[e("div",{staticClass:"btn-group btn-group-sm",attrs:{role:"group","aria-label":"date range"}},[e("button",{staticClass:"btn btn-secondary",class:{active:0===t.sort},attrs:{type:"button"},on:{click:function(a){return t.sortByDefault()}}},[t._v(" 默认排序 ")]),e("button",{staticClass:"btn btn-secondary",class:{active:1===t.sort},attrs:{type:"button"},on:{click:function(a){return t.sortByAlphabet()}}},[t._v(" 按地区 ")]),e("button",{staticClass:"btn btn-secondary",class:{active:2===t.sort},attrs:{type:"button"},on:{click:function(a){return t.sortByNumber()}}},[t._v(" 按人数 ")]),e("button",{staticClass:"btn btn-secondary",class:{active:3===t.sort},attrs:{type:"button"},on:{click:function(a){return t.sortByIncreaseNumber()}}},[t._v(" 按变化 ")])])]),e("div",{staticStyle:{"max-height":"500px","overflow-y":"scroll"}},[e("table",{staticClass:"table table-striped table-hover"},[t._m(0),e("tbody",[t._l(t.regionData,(function(a){return e("tr",{key:a.id,staticClass:"singleRegionData"},[e("th",[t._v(t._s(a.location))]),e("td",[t._v(t._s(a.number))]),e("td",[t._v(t._s(a.change))])])})),e("tr")],2)])])])},y=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",{staticStyle:{position:"sticky"}},[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("NHS地区")]),e("th",{attrs:{scope:"col"}},[t._v("确诊人数")]),e("th",{attrs:{scope:"col"}},[t._v("较上次更新")])])])}],b=(e("4160"),e("caad"),e("ac1f"),e("25f0"),e("2532"),e("5319"),e("498a"),e("159b"),e("d0ff")),_=e("54f8"),g={name:"RegionTable",props:["dataNow","dataYesterday"],data:function(){return{regionData:[],sort:0}},mounted:function(){this.regionData=this.getRegionData()},methods:{getRegionData:function(){var t=JSON.parse(this.dataNow[0].area.replace(/\\/g,"")),a=JSON.parse(this.dataYesterday.area.replace(/\\/g,"")),e=function(t){null!=t.number&&(t.number.toString().includes(",")&&(t.number=t.number.replace(/,/g,"")),t.location=t.location.trim(),t.number=parseInt(t.number.toString().trim()))};t.forEach(e),a.forEach(e);var r,n=0,i=Object(_["a"])(t);try{for(i.s();!(r=i.n()).done;){var s=r.value;s.id=n++;var o=a[n]?s.number-a[n].number:0;s.change=(o>0?"+":"")+o}}catch(c){i.e(c)}finally{i.f()}return t},sortByDefault:function(){this.sort=0,this.regionData=Object(b["a"])(this.regionData).sort((function(t,a){return a.id-t.id}))},sortByAlphabet:function(){this.sort=1,this.regionData=Object(b["a"])(this.regionData).sort((function(t,a){return t.location.localeCompare(a.location)}))},sortByNumber:function(){this.sort=2,this.regionData=Object(b["a"])(this.regionData).sort((function(t,a){return a.number-t.number}))},sortByIncreaseNumber:function(){this.sort=3,this.regionData=Object(b["a"])(this.regionData).sort((function(t,a){return a.change-t.change}))}}},w=g,C=Object(f["a"])(w,m,y,!1,null,"dd0d8852",null),x=C.exports,k=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mBlock",attrs:{id:"barRace"}})},D=[],N=(e("4de4"),e("b0c0"),{name:"BarRace",data:function(){return{width:500}},created:function(){window.addEventListener("resize",this.myEventHandler)},destroyed:function(){window.removeEventListener("resize",this.myEventHandler)},methods:{myEventHandler:function(t){this.width=window.innerWidth>510?510:window.innerWidth-55,console.log(this.width)}},mounted:function(){this.myEventHandler();var t=e("5698"),a=t.select("#barRace").append("svg").attr("width",this.width).attr("height",500),r=500,n=12,i=500,s=this.width,o={top:80,right:0,bottom:5,left:0},c=(i-(o.bottom+o.top))/(5*n),l=(a.append("text").attr("class","title").attr("y",24).html("18 years of Interbrand’s Top Global Brands"),a.append("text").attr("class","subTitle").attr("y",55).html("Brand value, $m"),a.append("text").attr("class","caption").attr("x",s).attr("y",i-5).style("text-anchor","end").html("Source: Interbrand"),2e3);console.log(l),t.csv("./brand_values.csv").then((function(e){console.log(e),e.forEach((function(a){a.value=+a.value,a.lastValue=+a.lastValue,a.value=isNaN(a.value)?0:a.value,a.year=+a.year,a.colour=t.hsl(360*Math.random(),.75,.75)})),console.log(e);var d=e.filter((function(t){return t.year==l&&!isNaN(t.value)})).sort((function(t,a){return a.value-t.value})).slice(0,n);d.forEach((function(t,a){return t.rank=a})),console.log("yearSlice: ",d);var v=t.scaleLinear().domain([0,t.max(d,(function(t){return t.value}))]).range([o.left,s-o.right-65]),f=t.scaleLinear().domain([n,0]).range([i-o.bottom,o.top]),h=t.axisTop().scale(v).ticks(s>500?5:2).tickSize(-(i-o.top-o.bottom)).tickFormat((function(a){return t.format(",")(a)}));a.append("g").attr("class","axis xAxis").attr("transform","translate(0, ".concat(o.top,")")).call(h).selectAll(".tick line").classed("origin",(function(t){return 0==t})),a.selectAll("rect.bar").data(d,(function(t){return t.name})).enter().append("rect").attr("class","bar").attr("x",v(0)+1).attr("width",(function(t){return v(t.value)-v(0)-1})).attr("y",(function(t){return f(t.rank)+5})).attr("height",f(1)-f(0)-c).style("fill",(function(t){return t.colour})),a.selectAll("text.label").data(d,(function(t){return t.name})).enter().append("text").attr("class","label").attr("x",(function(t){return v(t.value)-8})).attr("y",(function(t){return f(t.rank)+5+(f(1)-f(0))/2+1})).style("text-anchor","end").html((function(t){return t.name})),a.selectAll("text.valueLabel").data(d,(function(t){return t.name})).enter().append("text").attr("class","valueLabel").attr("x",(function(t){return v(t.value)+5})).attr("y",(function(t){return f(t.rank)+5+(f(1)-f(0))/2+1})).text((function(a){return t.format(",.0f")(a.lastValue)}));var p=a.append("text").attr("class","yearText").attr("x",s-o.right).attr("y",i-25).style("text-anchor","end").html(~~l).call(u,10);t.interval((function(i){d=e.filter((function(t){return t.year==l&&!isNaN(t.value)})).sort((function(t,a){return a.value-t.value})).slice(0,n),d.forEach((function(t,a){return t.rank=a})),console.log("IntervalYear: ",d),v.domain([0,t.max(d,(function(t){return t.value}))]),a.select(".xAxis").transition().duration(r).ease(t.easeLinear).call(h);var s=a.selectAll(".bar").data(d,(function(t){return t.name}));s.enter().append("rect").attr("class",(function(t){return"bar ".concat(t.name.replace(/\s/g,"_"))})).attr("x",v(0)+1).attr("width",(function(t){return v(t.value)-v(0)-1})).attr("y",(function(t){return f(n+1)+5})).attr("height",f(1)-f(0)-c).style("fill",(function(t){return t.colour})).transition().duration(r).ease(t.easeLinear).attr("y",(function(t){return f(t.rank)+5})),s.transition().duration(r).ease(t.easeLinear).attr("width",(function(t){return v(t.value)-v(0)-1})).attr("y",(function(t){return f(t.rank)+5})),s.exit().transition().duration(r).ease(t.easeLinear).attr("width",(function(t){return v(t.value)-v(0)-1})).attr("y",(function(t){return f(n+1)+5})).remove();var o=a.selectAll(".label").data(d,(function(t){return t.name}));o.enter().append("text").attr("class","label").attr("x",(function(t){return v(t.value)-8})).attr("y",(function(t){return f(n+1)+5+(f(1)-f(0))/2})).style("text-anchor","end").html((function(t){return t.name})).transition().duration(r).ease(t.easeLinear).attr("y",(function(t){return f(t.rank)+5+(f(1)-f(0))/2+1})),o.transition().duration(r).ease(t.easeLinear).attr("x",(function(t){return v(t.value)-8})).attr("y",(function(t){return f(t.rank)+5+(f(1)-f(0))/2+1})),o.exit().transition().duration(r).ease(t.easeLinear).attr("x",(function(t){return v(t.value)-8})).attr("y",(function(t){return f(n+1)+5})).remove();var u=a.selectAll(".valueLabel").data(d,(function(t){return t.name}));u.enter().append("text").attr("class","valueLabel").attr("x",(function(t){return v(t.value)+5})).attr("y",(function(t){return f(n+1)+5})).text((function(a){return t.format(",.0f")(a.lastValue)})).transition().duration(r).ease(t.easeLinear).attr("y",(function(t){return f(t.rank)+5+(f(1)-f(0))/2+1})),u.transition().duration(r).ease(t.easeLinear).attr("x",(function(t){return v(t.value)+5})).attr("y",(function(t){return f(t.rank)+5+(f(1)-f(0))/2+1})).tween("text",(function(a){var e=t.interpolateRound(a.lastValue,a.value);return function(a){this.textContent=t.format(",")(e(a))}})),u.exit().transition().duration(r).ease(t.easeLinear).attr("x",(function(t){return v(t.value)+5})).attr("y",(function(t){return f(n+1)+5})).remove(),p.html(~~l),2018==l&&(l=2e3),l=t.format(".1f")(+l+.1),console.log(l)}),r)}));var u=function(t,a){t.select((function(){return this.parentNode.insertBefore(this.cloneNode(!0),this)})).style("fill","#ffffff").style("stroke","#ffffff").style("stroke-width",a).style("stroke-linejoin","round").style("opacity",1)}}}),L=N,H=(e("b612"),Object(f["a"])(L,k,D,!1,null,"0b9970da",null)),j=H.exports,O={name:"App",components:{Chart:p,RegionTable:x,BarRace:j},data:function(){return{dataNow:null,dataHistory:null,dataUK:null,todayData:null,yestData:null,section:0}},mounted:function(){var t=this;fetch("https://api.covid19uk.live/").then(function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(e){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.json();case 2:r=a.sent,t.$data.dataNow=r.data;case 4:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()),fetch("https://api.covid19uk.live/history").then(function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(e){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.json();case 2:r=a.sent,t.$data.dataHistory=r.data,t.todayData=t.dataHistory[t.dataHistory.length-1],t.yestData=t.dataHistory[t.dataHistory.length-2];case 6:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()),fetch("https://api.apify.com/v2/key-value-stores/KWLojgM5r1JmMW4b4/records/LATEST?disableRedirect=true").then(function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(e){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.json();case 2:r=a.sent,t.$data.dataUK=r;case 4:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()),document.addEventListener("scroll",(function(){window.scrollY>t.$refs["navPlaceholder"].offsetTop?(t.$refs["nav"].classList.add("fixed_nav"),t.$refs["navPlaceholder"].classList.add("navPlaceholder")):(t.$refs["nav"].classList.remove("fixed_nav"),t.$refs["navPlaceholder"].classList.remove("navPlaceholder"))}))},computed:{confirmedAndDeathChart1:function(){return[{name:"总确诊",data:this.dataHistory.map((function(t){return t.confirmed}))},{name:"总死亡",data:this.dataHistory.map((function(t){return t.death}))}]},deathChart2:function(){var t=0,a=0;return[{name:"新增确诊",data:this.dataHistory.map((function(a){var e=a.confirmed-t;return t=a.confirmed,e}))},{name:"新增死亡",data:this.dataHistory.map((function(t){var e=t.death-a;return a=t.death,e}))}]},rateChart3:function(){return[{name:"死亡率",data:this.dataHistory.map((function(t){var a=(t.death/t.confirmed).toPrecision(2);return a}))},{name:"治愈率",data:this.dataHistory.map((function(t){var a=(t.cured/t.confirmed).toPrecision(2);return a}))}]}}},S=O,R=Object(f["a"])(S,n,i,!1,null,null,null),A=R.exports,E=e("33bc");r["a"].use(E["b"],{easing:E["a"].Quartic.InOut}),r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(A)}}).$mount("#app")},b612:function(t,a,e){"use strict";var r=e("4a12"),n=e.n(r);n.a}});
//# sourceMappingURL=app.efc484b9.js.map